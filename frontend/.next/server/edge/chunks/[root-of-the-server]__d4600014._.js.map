{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/context/AuthContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AuthProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/context/AuthContext.tsx <module evaluation>\",\n    \"AuthProvider\",\n);\nexport const useAuth = registerClientReference(\n    function() { throw new Error(\"Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/context/AuthContext.tsx <module evaluation>\",\n    \"useAuth\",\n);\n"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,yMAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,yDACA;AAEG,MAAM,UAAU,CAAA,GAAA,yMAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,yDACA"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/context/AuthContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AuthProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/context/AuthContext.tsx\",\n    \"AuthProvider\",\n);\nexport const useAuth = registerClientReference(\n    function() { throw new Error(\"Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/context/AuthContext.tsx\",\n    \"useAuth\",\n);\n"],"names":[],"mappings":";;;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,yMAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,qCACA;AAEG,MAAM,UAAU,CAAA,GAAA,yMAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,qCACA"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["// middleware.ts\r\nimport { NextResponse } from 'next/server';\r\nimport type { NextRequest } from 'next/server';\r\nimport { useAuth } from './context/AuthContext';\r\nimport Cookies from 'js-cookie';\r\nexport async function middleware(request: NextRequest) {\r\n  const path = request.nextUrl.pathname;\r\n  const { isAuthenticated , userRole} = useAuth();\r\n  // General pages that the user should not visit if they are logged in.\r\n  const publicAuthPages = [\r\n    '/auth/login',\r\n    '/auth/signup',\r\n    '/auth/signup/host',\r\n    '/auth/signup/user',\r\n  ];\r\n\r\n  // Protected pathways by role\r\n  const protectedPaths = [\r\n    { path: '/admin', role: 'admin' },\r\n    { path: '/host', role: 'host' },\r\n    { path: '/user', role: 'user' },\r\n    { path: '/profile', role: ['user', 'admin', 'host'] },\r\n  ];\r\n\r\n  // Check if the path is protected.\r\n  const protectedPath = protectedPaths.find((p) => path.startsWith(p.path));\r\n\r\n  const tokent = Cookies.get(\"token\");\r\n  console.log(\"token\", tokent)\r\n  // ✅ تحقق من حالة تسجيل الدخول باستخدام API محمية\r\n\r\n  // ✅ المستخدم مسجل دخول، لا تدعه يدخل صفحات auth\r\n  if (publicAuthPages.some((p) => path.startsWith(p))) {\r\n    // Redirect by role\r\n    if (isAuthenticated && userRole) {\r\n      if (userRole === 'admin') {\r\n        return NextResponse.redirect(new URL('/admin/dashboard', request.url));\r\n      } else if (userRole === 'host') {\r\n        return NextResponse.redirect(new URL('/host/dashboard', request.url));\r\n      } else if (userRole === 'user') {\r\n        return NextResponse.redirect(new URL('/user/dashboard', request.url));\r\n      }\r\n    }\r\n  }\r\n\r\n  // 🔒 Protection of protected paths\r\n  if (protectedPath) {\r\n    if (!isAuthenticated || !userRole) {\r\n      return NextResponse.redirect(new URL('/auth/login', request.url));\r\n    }\r\n\r\n    const requiredRole = protectedPath.role;\r\n    if (Array.isArray(requiredRole)) {\r\n      if (!requiredRole.includes(userRole)) {\r\n        // Check the required role for the protected path.\r\n        return NextResponse.redirect(new URL('/unauthorized', request.url));\r\n      }\r\n    } else {\r\n      if (userRole !== requiredRole) {\r\n        return NextResponse.redirect(new URL('/unauthorized', request.url));\r\n      }\r\n    }\r\n  }\r\n\r\n  return NextResponse.next();\r\n}\r\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;AAChB;AAAA;AAEA;AACA;;;;AACO,eAAe,WAAW,OAAoB;IACnD,MAAM,OAAO,QAAQ,OAAO,CAAC,QAAQ;IACrC,MAAM,EAAE,eAAe,EAAG,QAAQ,EAAC,GAAG,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAC5C,sEAAsE;IACtE,MAAM,kBAAkB;QACtB;QACA;QACA;QACA;KACD;IAED,6BAA6B;IAC7B,MAAM,iBAAiB;QACrB;YAAE,MAAM;YAAU,MAAM;QAAQ;QAChC;YAAE,MAAM;YAAS,MAAM;QAAO;QAC9B;YAAE,MAAM;YAAS,MAAM;QAAO;QAC9B;YAAE,MAAM;YAAY,MAAM;gBAAC;gBAAQ;gBAAS;aAAO;QAAC;KACrD;IAED,kCAAkC;IAClC,MAAM,gBAAgB,eAAe,IAAI,CAAC,CAAC,IAAM,KAAK,UAAU,CAAC,EAAE,IAAI;IAEvE,MAAM,SAAS,6JAAA,CAAA,UAAO,CAAC,GAAG,CAAC;IAC3B,QAAQ,GAAG,CAAC,SAAS;IACrB,iDAAiD;IAEjD,gDAAgD;IAChD,IAAI,gBAAgB,IAAI,CAAC,CAAC,IAAM,KAAK,UAAU,CAAC,KAAK;QACnD,mBAAmB;QACnB,IAAI,mBAAmB,UAAU;YAC/B,IAAI,aAAa,SAAS;gBACxB,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,oBAAoB,QAAQ,GAAG;YACtE,OAAO,IAAI,aAAa,QAAQ;gBAC9B,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,mBAAmB,QAAQ,GAAG;YACrE,OAAO,IAAI,aAAa,QAAQ;gBAC9B,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,mBAAmB,QAAQ,GAAG;YACrE;QACF;IACF;IAEA,mCAAmC;IACnC,IAAI,eAAe;QACjB,IAAI,CAAC,mBAAmB,CAAC,UAAU;YACjC,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,eAAe,QAAQ,GAAG;QACjE;QAEA,MAAM,eAAe,cAAc,IAAI;QACvC,IAAI,MAAM,OAAO,CAAC,eAAe;YAC/B,IAAI,CAAC,aAAa,QAAQ,CAAC,WAAW;gBACpC,kDAAkD;gBAClD,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,QAAQ,GAAG;YACnE;QACF,OAAO;YACL,IAAI,aAAa,cAAc;gBAC7B,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,iBAAiB,QAAQ,GAAG;YACnE;QACF;IACF;IAEA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B"}}]
}